---
title: "Tutorial 1: Brain Imaging Data Structure"
teaching: 40
exercises: 20
questions:
- "What is BIDS?"
- "Why BIDS?"
- "How a BIDS dataset can be made?"
- "How a BIDS dataset can be query?"
objectives:
- Introduction to BIDS and its ecosystem
- Get familiar with the summerschool dataset that will be used throughout most of the tutorials
keypoints:
- BIDS is a community-driven standard to organize your existing raw data, with well-accepted file formats, and consistent and complete documentation to facilitate re-use by your future self and others; BIDS is not a new file format or a search engine or a data sharing tool.
- It exists a large ecosystem of tools around BIDS to support you in the tasks of dataset creation, validation, manipulation, and analysis and supported by great tutorials.
---
Hand over the stage to Sebastien.

- [Link (Under development)](../presentations/tutorial01/index.html) to slides.

> ## Prerequisites
>
> For best learning outcome, it is essential to have a basic understanding of:
> - Unix operating system, command line, shell, and Python
>
> If not, we recommend you to follow the lessons for [the unix shell](https://swcarpentry.github.io/shell-novice/) and for [Programming in Python](https://swcarpentry.github.io/python-novice-inflammation/) made by Software Carpentry.
>
> Although not essential it is also helpful to have an understanding of:
> - How brain imaging data are exported from a scanner
{: .prereq}

### Introduction

The dataset that will be used throughout most of the tutorials of the summer school follows the Brain Imaging Data Structure (BIDS) standard. This tutorial introduces you to BIDS and its eco-system.

> ## Tutorial outline
> - What is BIDS?
> - Why BIDS?
> - Getting familiar with BIDS and the summer school dataset
> - How can I convert to BIDS?
{: .callout}

###  What is BIDS?

- [Brain Imaging Data Structure](http://bids.neuroimaging.io) (BIDS) is a standard for describing and organizing neuroimaging data and metadata.

- Based on simple file formats and folder structures to reflect current lab practices and make it accessible to a wide range of scientists coming from different backgrounds.

<p>
    <img src="https://bids.neuroimaging.io/assets/img/dicom-reorganization-transparent-white_1000x477.png" style="color-background: black; width: 70%">
</p>

- Developed by a community of scientists working within the [International Neuroinformatics Coordinating Facility](http://incf.org) and in the neuroimaging field ([GitHub Repository](https://github.com/INCF/BIDS)).

> ## Selected external lesson Material
> 1. Krzysztof Gorgolewski's overview of BIDS and reproducibility: [Towards open and reproducible neuroscience in the age of big data](https://www.slideshare.net/chrisfilo1/towards-open-and-reproducible-neuroscience-in-the-age-of-big-data)
> 2. The [BIDS Specification](https://bids-specification.readthedocs.io/en/stable/)
> 3. "The brain imaging data structure, a format for organizing and describing outputs of neuroimaging experiments" (Gorgolewski et al 2016) [doi:10.1038/sdata.2016.44](http://n2t.net/doi:10.1038/sdata.2016.44)
> 4. Arnaud Delorme's presentation of BIDS-EEG: [The BIDS Neuroimaging Data Format for EEG](https://www.youtube.com/watch?v=du9waxN5Wcc&t=337s&ab_channel=EEGLAB)
> 5. ReproNim lesson: [FAIR data module](http://www.repronim.org/module-FAIR-data/01-Web-of-Data/)
{: .callout}

<!-- BIDS (Brain Imaging Data Structure) is a standard for the organization and description of neuroimaging and corresponding behavioral data, which has been largely lacking within the neuroimaging community. More specifically, data that come off the scanner are converted to NIFTI and JSON files, organized into a specific directory schema, and labeled following a precise naming convention. The result is an organized dataset that can be easily shared and understood by other researchers. -->

###  Why BIDS?

1. Data Sharing and Reproducibility: BIDS allows us to facilitate data sharing to a greater extent. By providing a consistent and well-specified way to organize and document neuroimaging data and metadata, it prevents not only the situation in which you spend hours in making sense of the data shared by a colleague or your past-self, but also the situation in which you spend hours in finding pertinent information. The improvement of data sharing induced by BIDS allows us to better assess and reproduce others’ experimental findings.

2. Ecosystem of tools such as the [BIDS-validator](https://github.com/bids-standard/bids-validator), to automatically check datasets for adherence to the specification, [OpenNeuro](https://openneuro.org/), as a open database for sharing datasets structured following BIDS, or the so-called [“BIDS Apps”](https://bids-apps.neuroimaging.io/), a collection of portable neuroimaging analysis pipelines that take BIDS datasets as input.

3. Share your own BIDS-app(s): By developing a tool that can handle BIDS formatted datasets, you create at the same time a BIDS-app that is potentially applicable to a large range of users as BIDS becomes increasingly popular.

> ## Suggested external reference
> 1. [Andy's Brain Book](https://andysbrainbook.readthedocs.io/en/latest/OpenScience/OS/BIDS_Overview.html)
{: .callout}

###  How BIDS is different from the existing solutions

*   BIDS is just a collection of files structured in folders accordingly to the specifications. It is intentionally based on simple file formats and folder structures to reflect current lab practices and make it accessible to a wide range of scientists coming from different backgrounds.

*   Existing solutions are more online databases that make (1) harder to manipulate with data and (2) data completely dependent on the database

*   Focus on interoperability, simplicity, public data sharing, community, and extensibility.

###  Getting familiar with BIDS and the summer school dataset

The dataset that will be used in this tutorial and throughout most of the tutorials of the summer school consists of a sample of the [VEPCON dataset](https://openneuro.org/datasets/ds003505/versions/1.0.2), a multimodal neuroimaging dataset created by our consortium. It is located in `$HOME/Data/ds003505` in the virtual machine provided for the summer school. 

It follows the BIDS standard and provides raw data of high-density EEG, structural MRI and diffusion weighted images (DWI) recorded for the first of the 20 participants. Visual evoked potentials were recorded while the participant discriminated briefly presented faces from scrambled faces, or coherently moving stimuli from incoherent ones. You can find below an overview of the dataset content along with a short description of each file.


```output
$HOME/Data/ds003505                         
├── dataset_description.json                -> Describes briefly the dataset in JSON format
├── participants.tsv                        -> Table file that stores demographical information of the participants
├── participants.json                       -> Describes the columns of participants.tsv table file
├── CHANGES                                 -> Describes changes between dataset versions   
├── README                                  -> Describes the dataset in more details in Markdown format
└── sub-01
│   ├── anat
│   │   ├── sub-01_T1w.nii.gz               -> Raw T1w MRI stored in Nifti format
│   │   └── sub-01_T1w.json                 -> Describes acquisition parameters related to the Nifti image
│   ├── dwi
│   │   ├── sub-01_dwi.nii.gz               -> Raw diffusion MRI stored in Nifti format
│   │   ├── sub-01_dwi.json                 -> Describes acquisition parameters related to the Nifti image
│   │   ├── sub-01_dwi.bval                 -> Describes the b-value for each diffusion gradient direction
│   │   └── sub-01_dwi.bvec                 -> Describes the diffusion gradient directions
│   └── eeg
│       ├── sub-01_coordsystem.json         -> Describes coordinate system, units, fiducials, anatomical landmarks location
│       ├── sub-01_electrodes.tsv           -> Location of electrodes expressed in the coordinate system and units described in _coordsystem.json file
│       ├── sub-01_task-faces_channels.tsv  -> List the channels
│       ├── sub-01_task-faces_eeg.bdf       -> Raw EEG data in .bdf format
│       ├── sub-01_task-faces_eeg.json      -> Describes acquisition parameters of the raw EEG data
│       ├── sub-01_task-faces_events.tsv    -> Table file that describes each event 
│       └── sub-01_task-faces_events.json   -> Describes the columns of the _events.tsv table file
└── derivatives                             -> Stores the derivatives i.e. the data generated during the tutorials

```

> ## External supporting material
> 1. VEPCON preprint: “Source imaging of high-density visual evoked potentials with multi-scale brain parcellations and connectomes” (D. Pascucci, S. Tourbier et al 2020) [doi: 10.1101/2021.03.16.435599](https://doi.org/10.1101/2021.03.16.435599)
{: .callout}

In this exercise you will work through the creation of a BIDS dataset using a sample of the summerschool dataset that was made not BIDS-compliant. 

> ## Exercise 1: Create a BIDS-compliant dataset (click on the arrow to open)
> 1. Go to the `$HOME/Data/ds003505-sample` directory that stores a modified version of the dataset that will be used during most of the tutorials of this summer school, created for the purpose of this exercise.
> 2. Working with the BIDS material provided (above) and information from the [data publication in Nature Scientific Data](https://www.nature.com/articles/sdata2016110) and re-work the base dataset to conform to BIDS.
> 3. As you work through this exercise - you can use the [BIDS validator](http://incf.github.io/bids-validator/) to check your progress (must use Google Chrome or Firefox).
>
> > ## Solution (click on the arrow to open)
> >
> > To be compliant with BIDS, the files of the sample dataset should be named and structured in folders as follows:
> >
> > ~~~
> > tree $HOME/Data/ds003505-sample-solution
> > ~~~
> > {: .language-bash}
> > ~~~
> > ├── CHANGES
> > ├── README
> > ├── dataset_description.json
> > ├── participants.json
> > ├── participants.tsv
> > └── sub-01
> >     ├── anat
> >     │   ├── sub-01_T1w.json
> >     │   └── sub-01_T1w.nii.gz
> >     └── dwi
> >         ├── sub-01_dwi.bval
> >         ├── sub-01_dwi.bvec
> >         ├── sub-01_dwi.json
> >         └── sub-01_dwi.nii.gz
> > ~~~
> > {: .output}
> >
> {: .solution}
{: .challenge}

In this exercise you will work through the manipulation of the summerschool sample dataset in Python with the help of the `pybids` library.

> ## Exercise 2: Manipulate the summerschool dataset in Python (click on the arrow to open)
> 1. Open a terminal in the VM
> 2. Launch `ipython`
> 3. Import the `BIDSLayout` class from the `pybids` library
> 4. Print a general overview of the object (hint: use the `print()` method)
> 5. Initialize a `BIDSLayout` object with the path of summerschool sample dataset
> 6. Use the `get()` method on the created object to get the path of the T1w image of `sub-01`
>    Hint: check the [`pybids` tutorial](https://github.com/bids-standard/pybids/blob/master/examples/pybids_tutorial.ipynb))
> 7. Similarly, use the `get()` method on the created object to get the path of the diffusion image of `sub-01`, but this time, by providing the argument in a python dictionary.
>    Hint: use the `**` operator to pass a number of arguments in the form of a key/value dictionary to a function.
> 8. List the available EEG tasks (hint: use `get_tasks()`)
>
> > ## Solution (click on the arrow to open)
> > ~~~
> > # Import the BIDSLayout class from pybids
> > from bids import BIDSLayout
> >
> > # Create the BIDSLayout object representing the summerschool sample dataset
> > layout = BIDSLayout("$HOME/Data/ds003505")
> >
> > # Get the list of T1w images available for sub-01
> > t1_files = layout.get(subject='01', extension='nii.gz', suffix='T1w', return_type='filename')
> > print(t1_files)
> >
> > # Get the list of DWI images available for sub-01
> > dwi_query = {
> >     "subject": "01",
> >     "extension": "nii.gz",
> >     "suffix": "dwi",
> >     "return_types": "filename"    
> > }
> > dwi_files = layout.get(**dwi_query)
> > print(dwi_files)
> >
> > # Get the list of EEG tasks available 
> > eeg_tasks = layout.get_tasks()
> > ~~~
> > {: .language-python}
> {: .solution}
{: .challenge}

###  How can I convert to BIDS?

For MRI, you will need to have access to raw data (e.g. dicoms) in order to perform the conversion. There are several different packages that can be used to accomplish this, such as [dcm2bids](https://github.com/UNFmontreal/Dcm2Bids), [heudiconv](https://github.com/nipy/heudiconv)/[reproin](https://github.com/ReproNim/reproin), [bidscoin](https://github.com/Donders-Institute/bidscoin), [bidskit](https://github.com/jmtyszka/bidskit).

For EEG, you will need to have access to raw data in order to perform the conversion. There are several different packages that supports this process, such as [mne-bids](https://github.com/mne-tools/mne-bids), [Fieldtrip](https://github.com/fieldtrip/fieldtrip) [data2bids](https://www.fieldtriptoolbox.org/reference/data2bids/), [bids-matlab-tools EEGLab addon](https://github.com/sccn/bids-matlab-tools), [Brainstorm](https://neuroimage.usc.edu/brainstorm), [BrainVision bv2bids](https://pressrelease.brainproducts.com/bv2bids/).

For physiological recordings, there exist [physio2bids](https://github.com/tarrlab/physio2bids) and [bidscoin](https://github.com/Donders-Institute/bidscoin) for data recorded with Siemens MRI scanner, and [phys2bids](https://github.com/physiopy/phys2bids) for data recorded by AcqKnowledge (BIOPAC) and Labchart (ADInstruments).

Admittingly, most BIDS converters require a bit of user input and work. A number of great tutorials are available online to help you getting started.

> ## Selected external tutorials
>
> **MRI data tools**
>
> *   dcm2bids:
>
>     *   [https://unfmontreal.github.io/Dcm2Bids/docs/2-tutorial/](https://unfmontreal.github.io/Dcm2Bids/docs/2-tutorial/)
>
>     *   [https://andysbrainbook.readthedocs.io/en/latest/OpenScience/OS/BIDS_Overview.html#bids-tutorial](https://andysbrainbook.readthedocs.io/en/latest/OpenScience/OS/BIDS_Overview.html#bids-tutorial)
>
> *   heudiconv: [https://reproducibility.stanford.edu/bids-tutorial-series-part-2a/](https://reproducibility.stanford.edu/bids-tutorial-series-part-2a/)
>
> *   bidskit: [https://github.com/jmtyszka/bidskit/blob/HEAD/docs/QuickStart.md](https://github.com/jmtyszka/bidskit/blob/HEAD/docs/QuickStart.md)
>
> *   bidscoin: [https://bidscoin.readthedocs.io/en/latest/tutorial.html](https://bidscoin.readthedocs.io/en/latest/tutorial.html)
>
> **EEG data tools**
>
> *   MNE-BIDS: [https://mne.tools/mne-bids/stable/auto_examples/convert_eeg_to_bids.html](https://mne.tools/mne-bids/stable/auto_examples/convert_eeg_to_bids.html)
>
> *   data2bids (FieldTrip): [https://www.fieldtriptoolbox.org/example/bids_eeg/](https://www.fieldtriptoolbox.org/example/bids_eeg/)
>
> *   bids-matlab-tools (EEGlab): [https://github.com/sccn/bids-matlab-tools/wiki](https://github.com/sccn/bids-matlab-tools/wiki)
>
> *   brainstorm: [Export BIDS](https://neuroimage.usc.edu/brainstorm/ExportBids) / [Import BIDS](https://neuroimage.usc.edu/brainstorm/Tutorials/RestingOmega)
>
> **Physiological data tools**
>
> *   Tutorial for phys2bids: [https://github.com/sccn/bids-matlab-tools/wiki](https://github.com/sccn/bids-matlab-tools/wiki)
{: .callout}

> ## Additional materials
>   - [ReproNim lessons](https://www.repronim.org/teach.html)
>   - [BIDS starter kit](https://github.com/bids-standard/bids-starter-kit)
>   - [Short presentation of BIDS by Jean-Baptiste Poline](https://www.youtube.com/watch?v=kxj0PLyzYsg&ab_channel=INCF)
>   - [BIDS data format for Neuroimaging: Export/Import BIDS EEG data from EEGLAB](https://www.youtube.com/watch?v=EClpeP7WREw&ab_channel=EEGLAB)
{: .callout}
